// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("rescript/lib/js/curry.js");
var Belt_List = require("rescript/lib/js/belt_List.js");
var Pervasives = require("rescript/lib/js/pervasives.js");
var Caml_option = require("rescript/lib/js/caml_option.js");
var Caml_js_exceptions = require("rescript/lib/js/caml_js_exceptions.js");

function list_find(_l, f) {
  while(true) {
    var l = _l;
    if (!l) {
      return ;
    }
    var x = l.hd;
    if (Curry._1(f, x)) {
      return Caml_option.some(x);
    }
    _l = l.tl;
    continue ;
  };
}

console.log(list_find({
          hd: 1,
          tl: {
            hd: 3,
            tl: {
              hd: 5,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            }
          }
        }, (function (x) {
            return x > 3;
          })));

console.log(list_find({
          hd: 1,
          tl: {
            hd: 3,
            tl: {
              hd: 5,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            }
          }
        }, (function (x) {
            return x > 10;
          })));

console.log(list_find({
          hd: "a",
          tl: {
            hd: "B",
            tl: {
              hd: "C",
              tl: /* [] */0
            }
          }
        }, (function (x) {
            return x === x.toUpperCase();
          })));

var If_not_found_1 = {};

function flexible_find_1(_l, f, if_not_found) {
  while(true) {
    var l = _l;
    if (!l) {
      if (typeof if_not_found === "number") {
        if (if_not_found !== 0) {
          return ;
        } else {
          return Pervasives.failwith("Element not found");
        }
      } else {
        return Caml_option.some(if_not_found._0);
      }
    }
    var hd = l.hd;
    if (Curry._1(f, hd)) {
      return Caml_option.some(hd);
    }
    _l = l.tl;
    continue ;
  };
}

var __x = flexible_find_1({
      hd: 1,
      tl: {
        hd: 2,
        tl: {
          hd: 5,
          tl: /* [] */0
        }
      }
    }, (function (x) {
        return x > 10;
      }), /* Return_none */1);

console.log("flexible_find_1", __x);

var __x$1 = flexible_find_1({
      hd: 1,
      tl: {
        hd: 2,
        tl: {
          hd: 5,
          tl: /* [] */0
        }
      }
    }, (function (x) {
        return x > 10;
      }), /* Default_to */{
      _0: 10
    });

console.log("flexible_find_1", __x$1);

try {
  var __x$2 = flexible_find_1({
        hd: 1,
        tl: {
          hd: 2,
          tl: {
            hd: 5,
            tl: /* [] */0
          }
        }
      }, (function (x) {
          return x > 10;
        }), /* Raise */0);
  console.log("flexible_find_1", __x$2);
}
catch (raw_e){
  var e = Caml_js_exceptions.internalToOCamlException(raw_e);
  console.log("flexible_find_1", e);
}

var __x$3 = flexible_find_1({
      hd: 1,
      tl: {
        hd: 2,
        tl: {
          hd: 20,
          tl: /* [] */0
        }
      }
    }, (function (x) {
        return x > 10;
      }), /* Raise */0);

console.log("flexible_find_1", __x$3);

var If_not_found_1$1 = {
  If_not_found_1: If_not_found_1,
  flexible_find_1: flexible_find_1
};

var If_not_found_2 = {};

function flexible_find_2(f, _list, if_not_found) {
  while(true) {
    var list = _list;
    if (!list) {
      if (typeof if_not_found === "number") {
        if (if_not_found !== 0) {
          return ;
        } else {
          return Pervasives.failwith("No matching item found");
        }
      } else {
        return if_not_found._0;
      }
    }
    var hd = list.hd;
    if (Curry._1(f, hd)) {
      if (typeof if_not_found === "number" && if_not_found !== 0) {
        return Caml_option.some(hd);
      } else {
        return hd;
      }
    }
    _list = list.tl;
    continue ;
  };
}

var __x$4 = flexible_find_2((function (x) {
        return x > 10;
      }), {
      hd: 1,
      tl: {
        hd: 2,
        tl: {
          hd: 5,
          tl: /* [] */0
        }
      }
    }, /* Return_none */1);

console.log("flexible_find_2", __x$4);

var __x$5 = flexible_find_2((function (x) {
        return x > 10;
      }), {
      hd: 1,
      tl: {
        hd: 2,
        tl: {
          hd: 5,
          tl: /* [] */0
        }
      }
    }, /* Default_to */{
      _0: 10
    });

console.log("flexible_find_2", __x$5);

try {
  var __x$6 = flexible_find_2((function (x) {
          return x > 10;
        }), {
        hd: 1,
        tl: {
          hd: 2,
          tl: {
            hd: 5,
            tl: /* [] */0
          }
        }
      }, /* Raise */0);
  console.log("flexible_find_2", __x$6);
}
catch (raw_e$1){
  var e$1 = Caml_js_exceptions.internalToOCamlException(raw_e$1);
  console.log("flexible_find_2", e$1);
}

var __x$7 = flexible_find_2((function (x) {
        return x > 10;
      }), {
      hd: 1,
      tl: {
        hd: 2,
        tl: {
          hd: 20,
          tl: /* [] */0
        }
      }
    }, /* Raise */0);

console.log("flexible_find_2", __x$7);

var If_not_found_2$1 = {
  If_not_found_2: If_not_found_2,
  flexible_find_2: flexible_find_2
};

function tuple_i_f(x, y) {
  return [
          x,
          y
        ];
}

function tuple_s_s(x, y) {
  return [
          x,
          y
        ];
}

function print_stringable(s) {
  console.log(Curry._1(s.to_string, s.value));
  
}

function id(x) {
  return x;
}

var stringables_0 = /* Stringable */{
  value: 100,
  to_string: (function (prim) {
      return String(prim);
    })
};

var stringables_1 = {
  hd: /* Stringable */{
    value: 12.3,
    to_string: (function (prim) {
        return String(prim);
      })
  },
  tl: {
    hd: /* Stringable */{
      value: "foo",
      to_string: id
    },
    tl: /* [] */0
  }
};

var stringables = {
  hd: stringables_0,
  tl: stringables_1
};

Belt_List.map(stringables, print_stringable);

exports.list_find = list_find;
exports.If_not_found_1 = If_not_found_1$1;
exports.If_not_found_2 = If_not_found_2$1;
exports.tuple_i_f = tuple_i_f;
exports.tuple_s_s = tuple_s_s;
exports.print_stringable = print_stringable;
exports.id = id;
exports.stringables = stringables;
/*  Not a pure module */
