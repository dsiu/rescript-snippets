// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Belt_Result from "@rescript/runtime/lib/es6/Belt_Result.js";

function makeStageA(x) {
  if (x !== 1) {
    if (x !== 2) {
      return {
        TAG: "Ok",
        _0: x
      };
    } else {
      return {
        TAG: "Error",
        _0: "ProblemA2"
      };
    }
  } else {
    return {
      TAG: "Error",
      _0: "ProblemA1"
    };
  }
}

function makeStageB(x) {
  if (x !== 1) {
    if (x !== 2) {
      return {
        TAG: "Ok",
        _0: x
      };
    } else {
      return {
        TAG: "Error",
        _0: "ProblemB2"
      };
    }
  } else {
    return {
      TAG: "Error",
      _0: "ProblemB1"
    };
  }
}

function makeStageC(x) {
  if (x !== 1) {
    if (x !== 2) {
      return {
        TAG: "Ok",
        _0: x
      };
    } else {
      return {
        TAG: "Error",
        _0: "ProblemC2"
      };
    }
  } else {
    return {
      TAG: "Error",
      _0: "ProblemC1"
    };
  }
}

function make(x) {
  let result = Belt_Result.flatMap(Belt_Result.flatMap(makeStageA(x), makeStageB), makeStageC);
  if (result.TAG === "Ok") {
    console.log("Ok");
    return;
  }
  let _p = result._0;
  if (_p === "ProblemA2") {
    console.log("Solve problem with bar");
  } else if (_p === "ProblemB1") {
    console.log("Solve problem with foo");
  } else {
    console.log("Do something other");
  }
}

export {
  makeStageA,
  makeStageB,
  makeStageC,
  make,
}
/* No side effect */
